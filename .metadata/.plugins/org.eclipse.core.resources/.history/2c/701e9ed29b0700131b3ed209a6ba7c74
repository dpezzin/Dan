package com.example.flash;

import com.example.flash.R;
import android.app.Activity;
import android.content.SharedPreferences;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.CheckBox;
import android.widget.EditText;

/*
 * Edit
 * Dan Pezzin
 * Flash Computer Services
 * 
 * Allows the user to change some settings for the text that
 * was displayed in the initial Activity, and save them via
 * the SharedPreferences object.
 */

public class Edit extends Activity implements OnClickListener {

	// fields for each UI element
	Button save, cancel;
	CheckBox bold;
	EditText text, text2, text3, text4;

	// define a "file name", of sorts, in which to store the preferences
	private final String PREFS_NAME = "Code2Prefs";


	public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.settings);
        
        // connect to View objects
        save =   (Button)findViewById(R.id.save);
        cancel = (Button)findViewById(R.id.cancel);
        bold =   (CheckBox)findViewById(R.id.checkBox);
        text =   (EditText)findViewById(R.id.itemName);
        text2 =   (EditText)findViewById(R.id.ClientName);
        text3 =   (EditText)findViewById(R.id.Date);
        text4 =   (EditText)findViewById(R.id.Time);
        
        // make sure our buttons do something
        save.setOnClickListener(this);
        cancel.setOnClickListener(this);
        
        // load saved preferences
        SharedPreferences prefs = getSharedPreferences(PREFS_NAME, MODE_PRIVATE);

        // check the checkbox if the stored preference is true
        boolean boldedText = prefs.getBoolean("boldedText", false);
        bold.setChecked(boldedText);
        
        // set the EditText views to the current string
        String welcomeText1 = prefs.getString("welcomeText1", getString(R.string.item_name));
        text.setText(welcomeText1);
        
        String welcomeText2 = prefs.getString("welcomeText2", getString(R.string.client_name));
        text.setText(welcomeText2);
        
        String welcomeText3 = prefs.getString("welcomeText3", getString(R.string.date));
        text.setText(welcomeText3);
        
        String welcomeText4 = prefs.getString("welcomeText4", getString(R.string.time));
        text.setText(welcomeText4);
        
	}


	/** Save the settings to PREFS_NAME via SharedPreferences
	 * object when requested.
	 */
	private void savePrefs() {
		// get our SharedPreferences object and create an editor for it
		SharedPreferences prefs = getSharedPreferences(PREFS_NAME, MODE_PRIVATE);
		SharedPreferences.Editor editor = prefs.edit();

		// place our settings in the object
		editor.putBoolean("boldedText", bold.isChecked());
		editor.putString("welcomeText1", text.getText().toString());
		editor.putString("welcomeText2", text2.getText().toString());
		editor.putString("welcomeText3", text3.getText().toString());
		editor.putString("welcomeText4", text4.getText().toString());
		
    	// we must commit the preferences or they won't be saved!
    	editor.commit();
		
	}


	/** Save the data, if requested, and quit this activity
	  */
	public void onClick(View v) {
		// save the preferences if the "Save" button was pushed
		if(v.getId() == R.id.save) savePrefs();
		
		// in either case, we'll close this activity
		finish();
	}

	
}
